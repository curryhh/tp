<!DOCTYPE html>
<html lang="en">

<head>
	<meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <title>手机报价系统</title>
    <meta name="description" content="这是一个手机报价页面">
    <meta name="keywords" content="index">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="renderer" content="webkit">
    <meta http-equiv="Cache-Control" content="no-siteapp" />
    <link rel="icon" type="image/png" href="__ADMIN__/assets/i/favicon.png">
    <link rel="apple-touch-icon-precomposed" href="__ADMIN__/assets/i/app-icon72x72@2x.png">
    <meta name="apple-mobile-web-app-title" content="Amaze UI" />
    <script src="__ADMIN__/assets/js/jquery.min.js"></script>
    <script src="__ADMIN__/assets/js/echarts.min.js"></script>
    <link rel="stylesheet" href="__ADMIN__/assets/css/amazeui.min.css" />
    <link rel="stylesheet" href="__ADMIN__/assets/css/amazeui.datatables.min.css" />
    <link rel="stylesheet" href="__ADMIN__/assets/css/app.css">
    <!-- webuploader -->
    <link rel="stylesheet" type="text/css" href="__ADMIN__/plugin/webuploader/webuploader.css" />
    <script type="text/javascript" src="__ADMIN__/plugin/webuploader/webuploader.js"></script>
</head>

<body data-type="widgets">
    <script src="__ADMIN__/assets/js/theme.js"></script>
    <div class="am-g tpl-g">
       	<!-- 内容区域 -->
        <div class="row">

                    <div class="am-u-sm-12 am-u-md-12 am-u-lg-12">
                        <div class="widget am-cf">
                            <div class="widget-head am-cf">
                                <div class="widget-title am-fl">添加文章</div>
                                <div class="widget-function am-fr">
                                    <a href="javascript:;" class="am-icon-cog"></a>
                                </div>
                            </div>
                            <div class="widget-body am-fr">

                                <form class="am-form tpl-form-border-form tpl-form-border-br" data-am-validator action="{:U ('addsave')}" method="post" enctype="multipart/form-data" >
                                    <div class="am-form-group">
                                        <label for="user-name" class="am-u-sm-3 am-form-label">标题 <span class="tpl-form-line-small-title">Title</span></label>
                                        <div class="am-u-sm-9">
                                            <input type="text" id="doc-vld-name-2-1" name="title" minlength="1" placeholder="请填写标题文字" required/>
                                            <small>请填写标题文字10-20字左右。</small>
                                        </div>
                                    </div>

                                    <div class="am-form-group">
                                        <label for="user-weibo" class="am-u-sm-3 am-form-label">封面图 <span class="tpl-form-line-small-title">Images</span></label>
                                        <div class="am-u-sm-9">
                                            <div class="am-form-group am-form-file">
                                                <div class="tpl-form-file-img">
                                                   <!--  <img src="__ADMIN__/assets/img/a5.png" alt=""> -->
                                                </div>
                                               <!--  <button type="button" class="am-btn am-btn-danger am-btn-sm">
    <i class="am-icon-cloud-upload"></i> 添加封面图片</button>
                                                <input id="doc-form-file" type="file"  multiple="" minlength="1" placeholder="请上传封面" > -->
                                                <!-- <input id="img" name='img' > -->
                                                <div id="fileList" class="uploader-list"></div>
                                                <div id="filePicker" required name="file">请上传封面</div>                         
                                            </div>

                                        </div>
                                    </div>
                                    <div class="am-form-group">
                                        <label for="user-intro" class="am-u-sm-3 am-form-label">文章内容</label>
                                        <div class="am-u-sm-9">
                                            <!-- <script id="editor" type="text/plain" ></script> -->
                                            <textarea class="am-validate" name="content" id="editor"  style="width:600px;height:300px;" minlength="1" required></textarea>
                                        </div>
                                    </div>

                                    <div class="am-form-group">
                                        <div class="am-u-sm-9 am-u-sm-push-3">
                                            <button type="submit" class="am-btn am-btn-primary tpl-btn-bg-color-success ">提交</button>
                                        </div>
                                    </div>
                                </form>
                            </div>
                        </div>
                    </div>
                </div>
    </div>
    <script src="__ADMIN__/assets/js/amazeui.min.js"></script>
    <script src="__ADMIN__/assets/js/amazeui.datatables.min.js"></script>
    <script src="__ADMIN__/assets/js/dataTables.responsive.min.js"></script>
    <script src="__ADMIN__/assets/js/app.js"></script>
    <script src="__ADMIN__/assets/js/layer.js"></script>
    <!-- ue文本 -->
    <script type="text/javascript" charset="utf-8" src="__ADMIN__/plugin/ue/ueditor.config.js"></script>
    <script type="text/javascript" charset="utf-8" src="__ADMIN__/plugin/ue/ueditor.all.min.js"> </script>
   
    <script type="text/javascript" charset="utf-8" src="__ADMIN__/plugin/ue/lang/zh-cn/zh-cn.js"></script>

    <script type="text/javascript">
        // ue
        var ue = UE.getEditor('editor');
        //上传

        // 初始化Web Uploader
        var uploader = WebUploader.create({

            // 选完文件后，是否自动上传。
            auto: true, 
            // swf文件路径
            swf:'__ADMIN__/plugin/webuploader/Uploader.swf',

            // 文件接收服务端。
            server: '{:U("webup")}',
            formData: { 
                //设置传入服务器的参数变量 
                //注意不要在此赋值 
                title: 123
            },
            // 选择文件的按钮。可选。
            // 内部根据当前运行是创建，可能是input元素，也可能是flash.
            pick: '#filePicker',
            //限定文件个数
            fileNumLimit:1,
            // 只允许选择图片文件。
            accept: {
                title: 'Images',
                extensions: 'gif,jpg,jpeg,bmp,png',
                mimeTypes: 'image/*'
            }
        });

        $list=$('.tpl-form-file-img');

        // 当有文件添加进来的时候
        uploader.on( 'fileQueued', function( file ) {
            var $li = $(
                    '<div id="' + file.id + '" class="file-item thumbnail">' +
                        '<img>' +
                        '<div class="info">' + file.name + '</div>' +
                    '</div>'

                    ),
                $img = $li.find('img');


            // $list为容器jQuery实例
            $list.append( $li );

            // 创建缩略图
            // 如果为非图片文件，可以不用调用此方法。
            // thumbnailWidth x thumbnailHeight 为 100 x 100
            uploader.makeThumb( file, function( error, src ) {
                if ( error ) {
                    $img.replaceWith('<span>不能预览</span>');
                    return;
                }

                $img.attr( 'src', src );
            }, 100, 100 );
        });

// 文件上传成功，给item添加成功class, 用样式标记上传成功。 
uploader.on( 'uploadSuccess', function( file, res ) { 
    console.log(res);//这里可以得到上传后的文件路径 
    $( '#'+file.id ).addClass('upload-state-done'); 
}); 

// ajax自动上传传值
// uploader.on( 'uploadBeforeSend', function( object, data,header ) {

//         // 修改data可以控制发送哪些携带数据。
//         data.title = $("#doc-vld-name-2-1").val();

//         })

// 写入name值
 // uploader.on('uploadAccept',function(object,ret){
 //    console.log(ret);

 //            var str=ret.file.savepath+ret.file.savename;          
 //                console.log(str);

 //                $("#img").attr('value',str);

            
 //        } );
         
    </script>
</body>

</html>